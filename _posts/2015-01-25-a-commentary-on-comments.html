---
layout: post
title: A Commentary On Comments
blurb: This is a comment.
tags: [Code, Software Engineering]
---
<div>
    <p>In software development, the extent to which comments are necessary is still debated.</p>

    <p>One side may argue that comments are incredibly critical to obtain software that works properly and is maintainable. On the other, comments are treated with disdain as the focus shifts to having self-documenting code. Who's right?</p>

    <p>
        The pragmatic answer to this debate would be “it depends.” The necessity and type of comments depends entirely on the quality of the code and the type of software being developed.
    </p>
    <br/>

    <h4>When Comments are Required</h4>
    <p>Some types of software absolutely require comments. Developers would have an incredibly difficult time using a publicly released API without proper documentation, no matter how good the code is.
        However, <strong>sometimes API documentation can go overboard</strong>, and it's hard to find a right balance.
    </p>
    <p>Complicated algorithms and documentation of strange side-effects should absolutely be commented, but one could also argue that code requiring such comments should be rewritten.</p>

    <p>
        Pragmatically, I believe that comments exist to make the maintenence or usage of an application easier. Looking at the situation from this maintenance perspective,
        having  <strong>comments that indicate WHY</strong> a piece of code is doing something is infinitely more useful than <strong>
        comments that say WHAT</strong> code is doing.
    </p>

    <h3>API Documentation is Hard</h3>
    <p>Consider this API for an audio device:</p>
    <pre>
    void setVolume(int volume)
    int getVolume();
    </pre>
    <br/>
    <p>A developer might be a bit careless with their documentation and add the following comments:</p>

    <pre>
    /**
    * Sets the volume.
    * @param volume the volume
    */
    void setVolume(int volume)

    /**
    * Gets the volume.
    * @return the volume
    */
    int getVolume();
    </pre>

    <br/>
    <p>That's absolutely useless documentation, even on a public API. It's just noise.</p>
    <p>It could have been made more useful with the following information:</p>

    <pre>
    /**
    * Sets the volume.
    * @param volume the volume, from 0-100 inclusive.
    */
    void setVolume(int volume)

    /**
    * Gets the volume.
    * @return the volume, from 0-100 inclusive.
    */
    int getVolume();
    </pre>

    <br/>
    <p>While more detailed, there is a hidden maintenance cost: what happens if the maximum volume changes from 100 to 1000? A developer would likely forget to update the comments, turning them into liars.</p>
    <p>Maybe a definition of the behavior would be better:</p>

    <pre>
    /**
    * Sets the volume.
    * @param volume the volume - if maximum is exceed, will be set to the maximum
    */
    void setVolume(int volume)

    /**
    * Gets the volume.
    * @return the volume
    */
    int getVolume();
    </pre>

    <p>Even then, the comments are kind of useless.</p>


    <h3>Avoid Comments that Say What - Use Methods Instead</h3>
    <p>Some developers like to add comments outlining WHAT the code is doing:</p>
    <pre>
    private void play() {
        //print greeting
        String playerName = "Joseph";
        String opponentName = "Bill the Computer";
        System.out.println("Hello " + playerName + " I am " + opponentName);
        System.out.println("Let's play a number game.");

        while (true) {
            //print input prompt
            System.out.print("Please guess a number (max is 5):" );

            //get guess
            Random number = new Random();
            int number2 = number.nextInt(5);
            Scanner reader = new Scanner(System.in);
            int guess = reader.nextInt();

            //print results
            if (guess == -1) { //quit
                System.out.println("buhbye");
                break;
            }
            else if (number2 == guess) { //winning
                System.out.println("You guessed " + guess + " and I was thinking of " + number2);
                System.out.println(meep + " you won!");
            }
            else if (number2 != guess) { //losing
                System.out.println("You guessed " + guess + " and I was thinking of " + number2);
                System.out.println("You lost loser");
            }
        }
    }
    </pre>

    <p>On the surface it seems easy to understand the code just by reading the comments. However, there are several pitfalls.<p>
    <p>One is that code changes. A comment that is accurate today may not be accurate tomorrow. It's an additional maintenance burden to make sure the comments are up to date and accurate.</p>
    <p>Second is that there is no guarantee that comments can be trusted. The 'get guess' comment in the example above is lying - it's also generating the random number that will be the answer.</p>

    <br/>
    <p>It would be easier to understand if these comments were turned into methods with well thought-out names:</p>
    <pre>
            private void play() {
              printGreeting();
              while (true) {
                printInputPrompt();
                int guessedNumber = getUserGuess();
                if (isQuitRequested(guessedNumber)) {
                    printGoodbye();
                    break;
                }
                int generatedNumber = generateRandomNumber();
                printResults(playerName, guessedNumber, generatedNumber);
            }
        </pre>
    <p>Not only is it easier to understand WHAT the program is doing, it isolates you from having to deal with HOW the program is doing it.</p>
    <p>It also has the advantage of providing guarantees of when and where a step starts and ends. Because all of the fields and values used by a method are tightly encapsulated in it, you have a gurantee that they won't bleed over into unrelated steps.</p>
    <br/>
    <p>
        There's definitely the possibility that the method names are lying. However, if a method doesn't produce the right result, you've narrowed it down and can ignore the unrelated methods.
        With the commented code, there can be a bug in the method, and you would have no way to knowing where it was introduced without tracing it.
    </p>
    <p>
        Maintenance-wise, method names can also go out of date, but I find that this rarely happens.
        When a method starts doing something it shouldn't, programmers catch it fairly quickly because a method that lies to them is a lot more serious and detectable than a comment that lies.
    </p>
    <p>
        Some people complain the code becomes longer as a result, but it is only by a few lines per method - well worth the ease of understanding.
    </p>
    <p>
        The only unanswered criticism I know of is that using methods makes you have to jump around a lot in the code.
    </p>


    <h3>Do Write Comments that Say Why</h3>
    <p>Comments that help you get into the mindset of the developer are invaluable:</p>
    <pre>
    public Record getRecord(int id) {
        Record record = recordDAO.get(id);
        record.getChildren(); //[JG]: children are lazy loaded - this ensures record's children are loaded and returned
        return record;
    }
    </pre>

    <p>If that comment was not present in the code, a developer may have removed the line thing it was a useless call with no effects.<p>

    <br/>
    <pre>
        public void startDownload(String fileToken) {
            frame.redirectTo(getDownloadUrl(fileToken));
            triggerDownloadEvents();
        }

        private void onDownloadFinished() {
            panel.remove(frame);
            panel.add(frame);   //[JG]: IE8 workaround: Frame is removed/added to clear history generated by download so it doesn't interfere with navigation.
        }
    </pre>

    <p>If that comment was not present in the code, it would look like a useless operation, and another developer could have introduced a navigation error.<p>

</div>
